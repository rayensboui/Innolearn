<!-- User Profile Quick Modal -->
<div class="modal-lite" id="profileModal">
    <div class="modal-lite-content profile-fast-card">
        <div class="profile-fast-header">
            <img src="https://ui-avatars.com/api/?name=Etudiant+User&background=6366f1&color=fff&bold=true" alt="User">
            <div class="profile-fast-meta">
                <h3>Etudiant User</h3>
                <span>Premium Member</span>
            </div>
        </div>
        <div class="profile-fast-stats">
            <div class="stat-mini">
                <span class="stat-val">12</span>
                <span class="stat-lbl">Cours</span>
            </div>
            <div class="stat-mini">
                <span class="stat-val">85%</span>
                <span class="stat-lbl">Progression</span>
            </div>
            <div class="stat-mini">
                <span class="stat-val">5</span>
                <span class="stat-lbl">Certifs</span>
            </div>
        </div>
        <div class="profile-fast-actions">
            <button class="btn-fast-action" onclick="showSettingsModal()">
                <i class="fas fa-user-edit"></i> Modifier le profil
            </button>
            <a href="{{ path('app_logout') }}" class="btn-fast-action logout-danger">
                <i class="fas fa-sign-out-alt"></i> Déconnexion
            </a>
        </div>
    </div>
</div>

<!-- Settings Comprehensive Modal -->
<div class="modal-overlay" id="settingsModal">
    <div class="modal-container settings-container">
        <div class="settings-sidebar">
            <h2>Paramètres</h2>
            <div class="settings-tabs">
                <div class="settings-tab active" data-tab="general"><i class="fas fa-user"></i> Général</div>
                <div class="settings-tab" data-tab="security"><i class="fas fa-shield-alt"></i> Sécurité</div>
                <div class="settings-tab" data-tab="notifications"><i class="fas fa-bell"></i> Notifications</div>
            </div>
            <button class="btn-close-settings" onclick="hideSettingsModal()">Fermer</button>
        </div>
        <div class="settings-body">
            <div class="settings-pane active" id="pane-general">
                <h3>Informations Générales</h3>
                <form class="settings-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Nom Complet</label>
                            <input type="text" value="Etudiant User" class="form-input">
                        </div>
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" value="student@innolearn.com" class="form-input">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Bio</label>
                        <textarea class="form-input" rows="3">Passionné de design UI/UX et de développement web symfony.</textarea>
                    </div>
                    <button type="button" class="btn-save-settings">Enregistrer les modifications</button>
                </form>
            </div>
            <div class="settings-pane" id="pane-security" style="display:none;">
                <h3>Sécurité & Mot de Passe</h3>
                <form class="settings-form">
                    <div class="form-group">
                        <label>Mot de passe actuel</label>
                        <input type="password" class="form-input">
                    </div>
                    <div class="form-group">
                        <label>Nouveau mot de passe</label>
                        <input type="password" class="form-input">
                    </div>
                    <button type="button" class="btn-save-settings">Mettre à jour la sécurité</button>
                </form>
            </div>
        </div>
    </div>
</div>

<style>
    /* Profile Fast Card */
    .modal-lite { position: fixed; top: 90px; right: 3rem; z-index: 2000; display: none; opacity: 0; transform: translateY(-10px); transition: all 0.3s ease; }
    .modal-lite.active { display: block; opacity: 1; transform: translateY(0); }
    .profile-fast-card { background: white; border-radius: 24px; width: 300px; padding: 1.5rem; box-shadow: 0 20px 40px rgba(0,0,0,0.12); border: 1px solid rgba(0,0,0,0.05); }
    .profile-fast-header { display: flex; align-items: center; gap: 1rem; margin-bottom: 1.5rem; }
    .profile-fast-header img { width: 48px; height: 48px; border-radius: 12px; }
    .profile-fast-meta h3 { font-size: 1rem; color: #1e293b; margin: 0; }
    .profile-fast-meta span { font-size: 0.75rem; color: #64748b; font-weight: 500; }
    .profile-fast-stats { display: flex; justify-content: space-between; background: #f8fafc; padding: 1rem; border-radius: 16px; margin-bottom: 1.5rem; }
    .stat-mini { text-align: center; display: flex; flex-direction: column; gap: 0.2rem; }
    .stat-val { font-size: 0.9rem; font-weight: 800; color: #6366f1; }
    .stat-lbl { font-size: 0.65rem; color: #94a3b8; font-weight: 700; text-transform: uppercase; }
    .profile-fast-actions { display: flex; flex-direction: column; gap: 0.75rem; }
    .btn-fast-action { border-radius: 10px; padding: 0.7rem; border: none; background: #f1f5f9; color: #475569; font-weight: 700; font-size: 0.85rem; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 0.5rem; transition: all 0.2s; text-decoration: none; }
    .btn-fast-action:hover { background: #e2e8f0; color: #1e293b; }
    .logout-danger:hover { background: #fef2f2; color: #ef4444; }

    /* Settings Modal */
    .modal-overlay { position: fixed; inset: 0; background: rgba(15, 23, 42, 0.4); backdrop-filter: blur(10px); z-index: 3000; display: none; align-items: center; justify-content: center; opacity: 0; transition: opacity 0.3s; }
    .modal-overlay.active { display: flex; opacity: 1; }
    .settings-container { background: white; width: 900px; height: 600px; border-radius: 32px; display: flex; overflow: hidden; transform: scale(0.95); transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1); }
    .modal-overlay.active .settings-container { transform: scale(1); }
    .settings-sidebar { width: 280px; background: #f8fafc; border-right: 1px solid #f1f5f9; padding: 2.5rem; display: flex; flex-direction: column; }
    .settings-sidebar h2 { font-size: 1.5rem; font-weight: 800; color: #1e293b; margin-bottom: 2rem; }
    .settings-tab { padding: 1rem; border-radius: 12px; color: #64748b; font-weight: 600; cursor: pointer; transition: all 0.2s; display: flex; align-items: center; gap: 0.75rem; }
    .settings-tab:hover { background: #f1f5f9; color: #1e293b; }
    .settings-tab.active { background: white; color: #6366f1; box-shadow: 0 4px 12px rgba(99, 102, 241, 0.08); }
    .btn-close-settings { margin-top: auto; padding: 1rem; border-radius: 12px; border: 1px solid #e2e8f0; background: white; color: #64748b; font-weight: 700; cursor: pointer; transition: all 0.2s; }
    .btn-close-settings:hover { background: #f1f5f9; color: #1e293b; }

    .settings-body { flex: 1; padding: 3rem; overflow-y: auto; }
    .settings-body h3 { font-size: 1.25rem; font-weight: 800; color: #1e293b; margin-bottom: 2rem; }
    .settings-form { display: flex; flex-direction: column; gap: 1.5rem; }
    .form-group { display: flex; flex-direction: column; gap: 0.5rem; }
    .form-group label { font-size: 0.9rem; font-weight: 700; color: #475569; }
    .form-input { padding: 1rem; border-radius: 14px; border: 1px solid #e2e8f0; background: #fcfdfe; font-size: 0.95rem; outline: none; transition: border-color 0.2s; }
    .form-input:focus { border-color: #6366f1; }
    .btn-save-settings { padding: 1rem; border-radius: 16px; background: #6366f1; color: white; font-weight: 700; border: none; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; align-self: flex-start; margin-top: 1rem; }
    .btn-save-settings:hover { transform: translateY(-2px); box-shadow: 0 10px 20px rgba(99, 102, 241, 0.2); }
    .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; }
</style>

<script>
function showProfileModal() { document.getElementById('profileModal').classList.toggle('active'); }
function showSettingsModal() { 
    document.getElementById('profileModal').classList.remove('active');
    document.getElementById('settingsModal').classList.add('active'); 
}
function hideSettingsModal() { document.getElementById('settingsModal').classList.remove('active'); }

document.addEventListener('DOMContentLoaded', function() {
    const profileToggle = document.getElementById('profileToggle');
    if (profileToggle) profileToggle.onclick = showProfileModal;

    // Tab switching logic
    const tabs = document.querySelectorAll('.settings-tab');
    tabs.forEach(tab => {
        tab.onclick = function() {
            tabs.forEach(t => t.classList.remove('active'));
            this.classList.add('active');
            const targetId = 'pane-' + this.getAttribute('data-tab');
            document.querySelectorAll('.settings-pane').forEach(p => {
                p.style.display = p.id === targetId ? 'block' : 'none';
            });
        };
    });

    // Close on overlay click
    const settingsModal = document.getElementById('settingsModal');
    settingsModal.onclick = (e) => {
        if (e.target === settingsModal) hideSettingsModal();
    }
});
</script>
